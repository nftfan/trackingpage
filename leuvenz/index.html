<!DOCTYPE html>
<html>
<head>
  <title>Population Estimator Dashboard</title>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <link rel="stylesheet" href="https://unpkg.com/leaflet/dist/leaflet.css" />
  <link rel="stylesheet" href="https://unpkg.com/leaflet-draw/dist/leaflet.draw.css" />
  <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.15.4/css/all.min.css" />
  <style>
    body {
      margin: 0;
      padding: 0;
      font-family: Arial, sans-serif;
    }

    #map-container {
      position: relative;
      width: 100%;
      height: 100vh;
    }

    #map {
      width: 100%;
      height: 100%;
      z-index: 1;
    }

    .button {
      padding: 10px 15px;
      background-color: #007bff;
      color: white;
      border: none;
      border-radius: 5px;
      cursor: pointer;
      font-size: 14px;
      font-weight: bold;
      display: flex;
      align-items: center;
      justify-content: center;
      box-shadow: 0 2px 5px rgba(0,0,0,0.2);
      transition: all 0.3s ease;
    }

    .button:hover {
      background-color: #0056b3;
      transform: translateY(-2px);
      box-shadow: 0 4px 8px rgba(0,0,0,0.2);
    }

    .button i {
      margin-right: 8px;
    }

    #draw-polygon-button {
      position: fixed;
      top: 20px;
      right: 20px;
      z-index: 999;
    }
    
    .copy-button {
      margin-top: 10px;
      background-color: #4CAF50;
      padding: 8px 12px;
      font-size: 13px;
    }

    .copy-button:hover {
      background-color: #45a049;
    }

    .population-info {
      margin-top: 10px;
      background-color: white;
      padding: 10px;
      border: 1px solid #ccc;
      border-radius: 5px;
    }

    .copied-notification {
      position: fixed;
      bottom: 20px;
      left: 50%;
      transform: translateX(-50%);
      background-color: rgba(0,0,0,0.7);
      color: white;
      padding: 10px 20px;
      border-radius: 5px;
      z-index: 1000;
      display: none;
    }

    @media screen and (max-width: 768px) {
      #draw-polygon-button {
        top: 10px;
        right: 10px;
        padding: 8px 12px;
        font-size: 12px;
      }
      
      .leaflet-popup-content {
        font-size: 14px;
      }
      
      .copy-button {
        width: 100%;
        margin-top: 5px;
      }
    }
  </style>
</head>
<body>
  <div id="map-container">
    <button id="draw-polygon-button" class="button">
      <i class="fas fa-map-marked-alt"></i> My Missions
    </button>
    <div id="map"></div>
  </div>
  
  <div id="copied-notification" class="copied-notification">
    Coordinates copied to clipboard!
  </div>

  <div id="population-info" class="population-info" style="display: none;">
    <strong style="font-size: 20px; color: #000000;">Offline Marketing Tool</strong>
  </div>

  <script src="https://unpkg.com/leaflet/dist/leaflet.js"></script>
  <script src="https://unpkg.com/leaflet-draw/dist/leaflet.draw.js"></script>
  <script>
    var map = L.map('map').setView([51.505, -0.09], 13);

    L.tileLayer('https://{s}.tile.openstreetmap.org/{z}/{x}/{y}.png', {
      maxZoom: 19,
      attribution: '&copy; <a href="https://www.openstreetmap.org/copyright">OpenStreetMap</a> contributors'
    }).addTo(map);

    var drawnItems = new L.FeatureGroup();
    map.addLayer(drawnItems);

    var drawControl = new L.Control.Draw({
      draw: {
        polygon: true,
        polyline: false,
        marker: false,
        circle: false,
        circlemarker: false,
        rectangle: false
      },
      edit: {
        featureGroup: drawnItems
      }
    });
    map.addControl(drawControl);

    map.on('draw:created', function (e) {
      var layer = e.layer;
      drawnItems.addLayer(layer);
      updateWaysCount(layer);
      displayCampaignArea(layer);

      // Add click event for the newly drawn polygon
      layer.on('click', function(e) {
        createCopyButton(layer);
      });
    });

    function updateWaysCount(layer) {
      var polygonPoints = layer.getLatLngs()[0].map(point => `${point.lat} ${point.lng}`).join(' ');
      var query = `[out:json];
        way(poly:"${polygonPoints}");
        out;
      `;

      fetch('https://overpass-api.de/api/interpreter', {
        method: 'POST',
        body: query
      })
      .then(response => response.json())
      .then(data => {
        var waysCount = data.elements.length;
        // Update ways count if needed
      })
      .catch(error => console.error('Error:', error));
    }

    function displayCampaignArea(layer) {
      var polygonPoints = layer.getLatLngs()[0].map(point => `[${point.lat}, ${point.lng}]`).join(', ');
      // Store the campaign area code
    }

    function createCopyButton(layer) {
      var coords = layer.getLatLngs()[0];
      var coordsString = JSON.stringify(coords.map(point => [point.lat, point.lng]));
      
      var popupContent = `
        <div style="text-align: center;">
          <strong>Campaign Area</strong><br>
          <button class="button copy-button" onclick="copyToClipboard('${coordsString.replace(/'/g, "\\'")}')">
            <i class="fas fa-copy"></i> Copy Coordinates
          </button>
        </div>
      `;
      
      layer.bindPopup(popupContent).openPopup();
    }

    // Global function for copying coordinates
    window.copyToClipboard = function(coordsString) {
      navigator.clipboard.writeText(coordsString).then(function() {
        showNotification();
      }, function(err) {
        console.error('Could not copy text: ', err);
      });
    };

    function showNotification() {
      var notification = document.getElementById('copied-notification');
      notification.style.display = 'block';
      setTimeout(function() {
        notification.style.display = 'none';
      }, 2000);
    }

  var polygonCoordinates = [
  [
    [50.86919046876775, 4.708000636494646],
    [50.86740291875487, 4.70928780972253],
    [50.866360149592126, 4.711068399354429],
    [50.86491106800252, 4.711218569564376],
    [50.865141298928215, 4.712484289905113],
    [50.86818836583931, 4.716195639378897],
    [50.870991491499375, 4.717826058800889],
    [50.872778903902045, 4.718233663656397],
    [50.873293449311475, 4.716259998040298],
    [50.87369966535897, 4.714436502634106],
    [50.87162792650076, 4.7120552321624976],
    [50.86955609555329, 4.7089016577541685]
  ],
  
  [[50.84834029714184, 4.695490523041089], [50.8549782674543, 4.695662146138143], [50.8559806543361, 4.692186778422852], [50.85264831200613, 4.69094251096922], [50.850968504477805, 4.689741149289844], [50.849451206969874, 4.69081379364642]], <!-- heverley -->
  
  [[50.85239544080322, 4.690937343182623], [50.85597162310055, 4.692138704861999], [50.85922245996537, 4.688320090952601], [50.85556525255834, 4.68063995735947], [50.852856025119095, 4.68162679016754], [50.85548397802501, 4.686732577304862]], <!-- heverley -->
  
  
  [[50.8760960812432, 4.725827173529252], [50.87820823900632, 4.719777459358152], [50.880509840385415, 4.718704815001575], [50.88373189132901, 4.717246018676638], [50.88430046542476, 4.724840340721222], [50.8819178228291, 4.72518358691529], [50.88156583120689, 4.721407878780144], [50.88018491531784, 4.724368377204313], [50.87858733411251, 4.7231241097506835], [50.87715217209129, 4.727586310274044]], <!-- kesello -->
  
  
  [[50.86873023330397, 4.698715209960938], [50.874200848247476, 4.700088500976563], [50.872088508674054, 4.703822135925294], [50.86921773990198, 4.707813262939454], [50.86826980572436, 4.704122543334962]],
  
  
  
  
  [[50.86938024096832, 4.707899093627931], [50.87149270328007, 4.711847305297852], [50.87357798883879, 4.714207649230958], [50.87452581506935, 4.711375236511231], [50.87593397844703, 4.707598686218263], [50.87620477421866, 4.706311225891114], [50.87536530220481, 4.7041654586792], [50.87452581506935, 4.702062606811524], [50.87401128322168, 4.700689315795899], [50.8712760448849, 4.705195426940919]],
  
  
  
  
  [[50.876421409703035, 4.706482887268067], [50.87352382675771, 4.713821411132813], [50.87780243724243, 4.715924263000489], [50.881078829039495, 4.714937210083009], [50.880293599103126, 4.710216522216798], [50.878046143736235, 4.70691204071045]],
  
  
  
  
  [[50.8811600589673, 4.714722633361817], [50.87912926828837, 4.702448844909669], [50.879968672500084, 4.700818061828614], [50.88243264268154, 4.705839157104493], [50.882378490891114, 4.7071266174316415], [50.884517438756795, 4.711289405822755]],
  
  
  
  
  
[[50.87910219048138, 4.7008609771728525], [50.880347753316656, 4.70991611480713], [50.87788367288198, 4.706783294677735], [50.87677344021729, 4.706225395202638], [50.87449873458739, 4.700946807861329], [50.87441749304715, 4.6999597549438485]],




[[50.882486794409026, 4.707083702087403], [50.884625737302635, 4.7112464904785165], [50.88689994861239, 4.708328247070313], [50.8881182304318, 4.704895019531251], [50.889580126558656, 4.70017433166504], [50.888659678791235, 4.70043182373047], [50.88746848409305, 4.699144363403321], [50.8872518999662, 4.702792167663575], [50.886791655353164, 4.701976776123048]],






[[50.86046892970548, 4.706611633300782], [50.862690145372106, 4.709358215332032], [50.862608883249116, 4.711976051330567], [50.86179625422952, 4.712276458740235], [50.86157955076561, 4.718027114868165], [50.85992715373515, 4.7178125381469735], [50.85889776204928, 4.721159934997559], [50.85770580644422, 4.718542098999024], [50.85832887794741, 4.71789836883545], [50.857759986905414, 4.715280532836915], [50.857759986905414, 4.712576866149903], [50.85962917426831, 4.71240520477295], [50.860035509432805, 4.708628654479981]],





[[50.87250827608297, 4.719250202178956], [50.87225099973244, 4.720237255096436], [50.86962399150566, 4.720816612243653], [50.8684458521006, 4.7222328186035165], [50.8687844009555, 4.725837707519532], [50.868648981708596, 4.72663164138794], [50.87058543952914, 4.727790355682373]],


[[50.86847293609949, 4.722254276275636], [50.864802910857854, 4.724743366241456], [50.86715934402803, 4.731824398040772], [50.869258365221654, 4.733283519744874], [50.87050419116752, 4.727833271026612], [50.86859481389967, 4.726588726043702], [50.868892736069775, 4.724271297454835]],


[[50.86478936779425, 4.724743366241456], [50.867240598219865, 4.731824398040772], [50.869258365221654, 4.733262062072755], [50.86799896384729, 4.7388625144958505], [50.86644159251613, 4.735536575317383], [50.86588634319952, 4.737446308135987], [50.86263597063919, 4.733777046203614], [50.864653936941835, 4.733347892761231], [50.86519565799099, 4.730086326599122], [50.864017406665795, 4.726288318634033]],


[[50.87265722490001, 4.7194862365722665], [50.87417376757672, 4.722404479980469], [50.875961058095015, 4.726009368896485], [50.877423335718774, 4.727811813354493], [50.875690260907206, 4.730558395385743], [50.874661217243, 4.728584289550782], [50.87434979165544, 4.728240966796876], [50.87348320515557, 4.725687503814698], [50.87306344652707, 4.722340106964111], [50.872345785921524, 4.720451831817628]],



[[50.88180989329177, 4.7239065170288095], [50.88151205368475, 4.721546173095704], [50.880320676217764, 4.724464416503907], [50.87858770915927, 4.723348617553712], [50.877315020431254, 4.7274255752563485], [50.87704423111104, 4.728584289550782], [50.878127378950914, 4.730429649353027], [50.87942712312659, 4.728498458862306], [50.87999574980355, 4.7274255752563485], [50.8813902096604, 4.723820686340333]],


[[50.88427376610816, 4.725022315979004], [50.884517438756795, 4.727983474731446], [50.88394886726078, 4.728498458862306], [50.88329906276881, 4.727554321289063], [50.88221603514223, 4.731931686401368], [50.88088929199056, 4.73012924194336], [50.881214212173845, 4.72914218902588], [50.88002282709126, 4.727597236633301], [50.88145790082436, 4.7239065170288095], [50.88180989329177, 4.723863601684571], [50.88197235045677, 4.7252798080444345]],


[[50.87992805651539, 4.7275757789611825], [50.8811600589673, 4.729099273681641], [50.88095698388226, 4.730386734008789], [50.88222957314292, 4.73188877105713], [50.881024675675604, 4.735450744628907], [50.88061852344034, 4.735708236694336], [50.87912926828837, 4.732489585876466], [50.87815445732434, 4.730386734008789]],

[[50.87246765359574, 4.7206449508667], [50.87038231835953, 4.729185104370118], [50.872630143332316, 4.7316741943359375], [50.87403836398688, 4.73287582397461], [50.87457997598601, 4.7304725646972665], [50.87455289553552, 4.732961654663086], [50.875581941591506, 4.735279083251954], [50.87709838910096, 4.732961654663086], [50.87449873458739, 4.728584289550782], [50.87344258351806, 4.725408554077149], [50.87306344652707, 4.722447395324707]],

[[50.87701715209247, 4.728841781616212], [50.875690260907206, 4.730558395385743], [50.87940004549268, 4.735407829284669], [50.88021236766478, 4.737296104431153], [50.880943445511775, 4.736394882202149], [50.87872309953162, 4.731631278991699], [50.87774828007073, 4.729785919189454]],

[[50.877260862693085, 4.733026027679443], [50.87548716198373, 4.735558032989502], [50.87646202874424, 4.738583564758302], [50.87792429064866, 4.736330509185792], [50.879075112658704, 4.7382402420043945], [50.88015821329388, 4.736609458923341], [50.878736638547224, 4.734549522399903], [50.87773474076796, 4.733691215515138]],

[[50.88019882907795, 4.736845493316651], [50.88053729256846, 4.738454818725587], [50.87740979632161, 4.74311113357544], [50.876475568416794, 4.738647937774659], [50.87799198684776, 4.73637342453003], [50.87910219048138, 4.738261699676514]],

[[50.8506076217602, 4.695625305175782], [50.850634716121945, 4.696784019470216], [50.86071272683848, 4.697384834289552], [50.85897903064014, 4.700131416320802], [50.85654091130268, 4.703135490417481], [50.856080363336936, 4.705066680908204], [50.86055019555811, 4.706611633300782], [50.86079399226619, 4.700388908386231], [50.86155246276182, 4.696226119995118]],


[[50.89212442338841, 4.718190692168469], [50.88592492481821, 4.719434959622101], [50.88497733051223, 4.718190692168469], [50.88427339083629, 4.716946424714839], [50.88348821480356, 4.718019069071416], [50.88451706346628, 4.728059020249008], [50.8856271115418, 4.726214071955668], [50.88779298285344, 4.723425196628593], [50.88979632416518, 4.727200904763738], [50.89177250887832, 4.724540746759423], [50.88985046732921, 4.721022473269839]],





[[50.87986036312891, 4.700646400451661], [50.88151205368475, 4.703865051269532], [50.88251387024918, 4.7057533264160165], [50.88243264268154, 4.70716953277588], [50.886683361842216, 4.701848030090333], [50.8872518999662, 4.702577590942384], [50.88749555703811, 4.698758125305177], [50.887278973037105, 4.696226119995118], [50.88427376610816, 4.698200225830079], [50.882920005963165, 4.69841480255127], [50.88164743556031, 4.699358940124513], [50.880943445511775, 4.699401855468751], [50.880266521972736, 4.7005605697631845]],
[[50.88925526471759, 4.694809913635255], [50.8883077380735, 4.694552421569825], [50.88708946121023, 4.696612358093263], [50.88275755210239, 4.698629379272462], [50.88118713557842, 4.699401855468751], [50.87991451784596, 4.700732231140138], [50.88018529048719, 4.699702262878419], [50.88129544186563, 4.6972131729125985], [50.88229726308748, 4.697084426879884], [50.88302830822234, 4.6939945220947275], [50.883840567141505, 4.6923208236694345], [50.886168964227345, 4.691419601440431], [50.88833481053079, 4.691848754882813], [50.88917404890332, 4.692277908325196]],
[[50.88132251839807, 4.690217971801759], [50.88386764219492, 4.6923208236694345], [50.882486794409026, 4.696784019470216], [50.88134959491482, 4.697384834289552], [50.87986036312891, 4.700646400451661], [50.87921050161489, 4.700517654418946]],
[[50.88300123268116, 4.683995246887208], [50.8849235570057, 4.685025215148927], [50.88749555703811, 4.688029289245606], [50.88863260652272, 4.6920204162597665], [50.88643970052214, 4.691376686096192], [50.88392179225454, 4.692363739013673], [50.881214212173845, 4.690518379211427], [50.88256802188226, 4.685325622558595]],
[[50.88294708155157, 4.683609008789063], [50.88002282709126, 4.682922363281251], [50.877206704892, 4.684038162231446], [50.878398161977145, 4.687771797180177], [50.879562511060016, 4.68918800354004], [50.88040190746729, 4.689316749572755], [50.881241288753486, 4.690132141113282]],
[[50.877152547027954, 4.6840810775756845], [50.87831692723451, 4.687514305114747], [50.8795895885995, 4.689359664916993], [50.879048034820244, 4.69219207763672], [50.87758580817798, 4.691033363342286], [50.875852739408714, 4.690561294555665], [50.87355090780611, 4.69167709350586], [50.87230516329265, 4.691076278686524], [50.87390296000361, 4.687385559082032], [50.8752569821338, 4.685497283935548]],
[[50.87908865157202, 4.6921706199646005], [50.879603127363325, 4.689166545867921], [50.8805102155797, 4.689338207244874], [50.88122775046563, 4.689981937408448], [50.88061852344034, 4.693737030029298], [50.88018529048719, 4.697320461273194], [50.879508355933844, 4.699616432189942], [50.87922404048887, 4.70043182373047], [50.879020956966066, 4.700882434844972], [50.87707131011386, 4.700453281402589], [50.877423335718774, 4.698286056518556], [50.877694122836104, 4.695475101470948], [50.87761288686611, 4.69268560409546], [50.87788367288198, 4.69144105911255]],
[[50.87577150022877, 4.690861701965333], [50.873984202440774, 4.691548347473145], [50.87409252547001, 4.693865776062013], [50.874850779625284, 4.694638252258302], [50.874850779625284, 4.696483612060548], [50.875284062175155, 4.697728157043458], [50.87601521734375, 4.6978139877319345], [50.87639433032257, 4.700603485107423], [50.87712546807231, 4.7005605697631845], [50.87753165075451, 4.693908691406251], [50.87796490837991, 4.691462516784669], [50.87666512341922, 4.690861701965333]],
[[50.86881148475767, 4.699058532714845], [50.87628601264333, 4.700367450714112], [50.87613707542327, 4.6987366676330575], [50.875974597913086, 4.6978139877319345], [50.8752569821338, 4.697771072387696], [50.874796619023314, 4.6964406967163095], [50.87486431976593, 4.694638252258302], [50.87421438857698, 4.694273471832276], [50.87401128322168, 4.693372249603272], [50.873984202440774, 4.691505432128907], [50.872386408515005, 4.691205024719239], [50.86913648915637, 4.69442367553711]],
[[50.87374047470445, 4.71489429473877], [50.87766704419516, 4.716138839721681], [50.88159328285729, 4.714465141296387], [50.88622311161217, 4.709701538085938], [50.88489648256591, 4.713435173034669], [50.88440913995918, 4.71639633178711], [50.883623966147674, 4.717297554016114], [50.87815445732434, 4.719614982604981], [50.87604229694451, 4.725708961486817], [50.87317177169636, 4.719786643981934], [50.8724405719179, 4.719099998474122]],
[[50.86599468504891, 4.696354866027833], [50.86539880176159, 4.698071479797364], [50.86596759961018, 4.7019338607788095], [50.86496542731422, 4.706525802612306], [50.86469456623886, 4.709057807922364], [50.86436953087126, 4.709272384643556], [50.8649925133352, 4.711332321166993], [50.86244635857825, 4.711890220642091], [50.86244635857825, 4.709358215332032], [50.86060437271451, 4.706611633300782], [50.86046892970548, 4.703264236450196], [50.86109196428943, 4.699015617370606], [50.86098361104675, 4.69717025756836], [50.861471198656, 4.696054458618165]],
[[50.86141702250675, 4.685926437377931], [50.868459394102004, 4.69841480255127], [50.867240598219865, 4.69742774963379], [50.86553423045024, 4.696097373962403], [50.861471198656, 4.69592571258545], [50.85502379493606, 4.695625305175782], [50.85553853637791, 4.693307876586915], [50.85721817946077, 4.690861701965333], [50.85971044158446, 4.6876859664917]],  
  [[50.86491125522505, 4.7112464904785165], [50.86675307094459, 4.71090316772461], [50.86726768291898, 4.709358215332032], [50.869001070932285, 4.707899093627931], [50.86821563747484, 4.704809188842774], [50.867944795283044, 4.701805114746095], [50.86835105798063, 4.6988868713378915], [50.86745727537231, 4.6975135803222665], [50.86596759961018, 4.696269035339356], [50.86529045852743, 4.697341918945313], [50.865642573117896, 4.699058532714845], [50.86594051415569, 4.701976776123048], [50.86512794320409, 4.705495834350587], [50.86474873857985, 4.708585739135743], [50.864071579793574, 4.709272384643556]]
];

// Define colors for each polygon
var polygonColors = ['red', 'red', 'red', 'red', 'red', 'red', 'red', 'red', 'red', 'red',
 'red', 'red', 'red', 'red', 'red', 'red', 'red', 'red', 'red', 'red',
 'red', 'red', 'red', 'red', 'red', 'red', 'red', 'red', 'red', 'red',
 'red', 'red', 'red', 'red', 'red', 'red', 'red', 'red', 'red', 'red',
 'red', 'red', 'red', 'red', 'red', 'red', 'red', 'red', 'red', 'red']

    document.getElementById('draw-polygon-button').addEventListener('click', function() {
      polygonCoordinates.forEach(function(coords, index) {
        var polygon = L.polygon(coords, { 
          color: polygonColors[index],
          weight: 2,
          opacity: 0.8,
          fillOpacity: 0.2
        }).addTo(map);
        
        // Add click event to show copy button
        polygon.on('click', function() {
          var coordsString = JSON.stringify(coords);
          
          var popupContent = `
            <div style="text-align: center;">
              <strong>Campaign Area</strong><br>
              <button class="button copy-button" onclick="copyToClipboard('${coordsString.replace(/'/g, "\\'")}')">
                <i class="fas fa-copy"></i> Copy Coordinates
              </button>
            </div>
          `;
          
          polygon.bindPopup(popupContent).openPopup();
        });
        
        map.fitBounds(polygon.getBounds());
      });
    });

    // For better mobile experience
    function setupResponsive() {
      if (window.innerWidth <= 768) {
        // Mobile-specific adjustments
        map.setOptions({ dragging: true, tap: true });
      }
    }

    // Run on page load and on resize
    setupResponsive();
    window.addEventListener('resize', setupResponsive);
    
    // Set initial view to show all polygons
    if (polygonCoordinates.length > 0) {
      var allCoords = [];
      polygonCoordinates.forEach(function(coords) {
        coords.forEach(function(coord) {
          allCoords.push([coord[0], coord[1]]);
        });
      });
      
      var bounds = L.latLngBounds(allCoords);
      map.fitBounds(bounds);
    }
  </script>
</body>
</html>
