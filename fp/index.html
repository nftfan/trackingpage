<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Photo Upload App</title>
  <link href="https://fonts.googleapis.com/icon?family=Material+Icons" rel="stylesheet">
  <style>
    body {
      font-family: Arial, sans-serif;
      background: #fafafa;
      margin: 0;
      padding: 0;
      max-width: 480px;
      margin: auto;
    }
    .header {
      position: sticky;
      top: 0;
      background: #2196f3;
      color: #fff;
      height: 56px;
      z-index: 2;
      display: flex;
      align-items: center;
      justify-content: flex-end;
      padding: 0 12px;
    }
    .upload-btn {
      background: none;
      border: none;
      cursor: pointer;
      outline: none;
      display: flex;
      align-items: center;
      padding: 0;
      height: 40px;
    }
    .upload-icon {
      font-size: 32px;
      user-select: none;
      border-radius: 50%;
      background: rgba(255,255,255,0.16);
      padding: 6px;
      color: #fff;
      transition: background 0.2s;
    }
    .upload-btn:active .upload-icon {
      background: rgba(255,255,255,0.32);
    }
    .thumbnails {
      display: flex;
      flex-wrap: wrap;
      gap: 8px;
      padding: 10px 16px 0 16px;
    }
    .thumb-img {
      width: 64px;
      height: 64px;
      border-radius: 8px;
      object-fit: cover;
      background: #eee;
      border: 2px solid #2196f3;
      margin-bottom: 2px;
      display: block;
      cursor: pointer;
      transition: box-shadow 0.2s;
    }
    .thumb-img:hover {
      box-shadow: 0 0 0 4px #2196f333;
    }
    .thumb-container {
      position: relative;
      display: inline-block;
    }
    .remove-thumb {
      position: absolute;
      top: -8px;
      right: -8px;
      background: #fff;
      border-radius: 50%;
      color: #f44336;
      font-size: 18px;
      border: 1px solid #f44336;
      cursor: pointer;
      width: 22px;
      height: 22px;
      display: flex;
      align-items: center;
      justify-content: center;
      z-index: 1;
    }
    .form-section {
      padding: 16px;
      display: flex;
      flex-direction: column;
      gap: 12px;
    }
    .form-section input[type='text'],
    .form-section input[type='tel'] {
      padding: 12px;
      border: 1px solid #ccc;
      border-radius: 6px;
      font-size: 16px;
    }
    .form-section button {
      background: #2196f3;
      color: #fff;
      border: none;
      padding: 12px;
      border-radius: 6px;
      font-size: 16px;
      cursor: pointer;
      display: flex;
      align-items: center;
      gap: 8px;
      justify-content: center;
    }
    .item-list {
      list-style: none;
      margin: 0;
      padding: 0 16px 16px 16px;
    }
    .item {
      background: #fff;
      border-radius: 8px;
      margin-bottom: 16px;
      padding: 10px;
      box-shadow: 0 1px 4px rgba(0,0,0,0.08);
      display: flex;
      flex-direction: column;
      align-items: stretch;
      gap: 10px;
    }
    .item-images {
      display: flex;
      gap: 8px;
      flex-wrap: wrap;
      justify-content: flex-start;
      margin-bottom: 8px;
    }
    .item-images img {
      width: 72px;
      height: 72px;
      border-radius: 6px;
      object-fit: cover;
      background: #eee;
      border: 2px solid #2196f3;
      cursor: pointer;
      transition: box-shadow 0.2s;
    }
    .item-images img:hover {
      box-shadow: 0 0 0 4px #2196f333;
    }
    .info-list {
      list-style: none;
      padding: 0;
      margin: 0;
      display: flex;
      flex-direction: column;
      gap: 3px;
    }
    .info-list li {
      display: flex;
      align-items: center;
      font-size: 1.05em;
      gap: 6px;
      color: #222;
      padding: 4px 0;
      border-radius: 4px;
    }
    .info-list .material-icons {
      font-size: 1.25em;
      color: #2196f3;
      background: #e3f2fd;
      border-radius: 50%;
      padding: 3px;
      margin-right: 3px;
    }
    .info-list .wa {
      color: #25D366;
      background: #e6f9eb;
    }
    .info-list .adcode {
      color: #ff9100;
      background: #fff8e1;
    }
    /* Popup styles */
    .popup-backdrop {
      position: fixed;
      z-index: 20;
      top: 0;
      left: 0;
      width: 100vw;
      height: 100vh;
      background: rgba(30,30,30,0.75);
      display: flex;
      align-items: center;
      justify-content: center;
      animation: fadeIn 0.2s;
    }
    .popup-img-container {
      position: relative;
      background: #fff;
      border-radius: 12px;
      padding: 6px;
      max-width: 95vw;
      max-height: 80vh;
      box-shadow: 0 6px 32px 4px #0004;
      display: flex;
      align-items: center;
      justify-content: center;
    }
    .popup-img {
      max-width: 90vw;
      max-height: 75vh;
      border-radius: 10px;
      display: block;
      background: #eee;
    }
    .popup-close {
      position: absolute;
      top: 8px;
      right: 8px;
      background: #fff;
      border-radius: 50%;
      color: #f44336;
      font-size: 32px;
      border: 2px solid #f44336;
      cursor: pointer;
      width: 38px;
      height: 38px;
      display: flex;
      align-items: center;
      justify-content: center;
      z-index: 30;
      box-shadow: 0 1px 8px 0 #0001;
    }
    @keyframes fadeIn {
      from { opacity: 0 }
      to { opacity: 1 }
    }
    @media (max-width: 400px) {
      .form-section, .item-list {
        padding-left: 8px;
        padding-right: 8px;
      }
      .thumbnails {
        padding-left: 8px;
        padding-right: 8px;
      }
      .item-images img {
        width: 56px;
        height: 56px;
      }
    }
  </style>
</head>
<body>
  <div class="header">
    <button id="upload-photos-btn" type="button" class="upload-btn" title="Upload photos">
      <span class="material-icons upload-icon">collections</span>
    </button>
    <input id="upload-photos-input" type="file" accept="image/*" multiple style="display:none;">
  </div>
  <div class="thumbnails" id="thumbnails"></div>
  <form class="form-section" id="item-form" autocomplete="off">
    <input type="text" id="title" placeholder="Title" required maxlength="40">
    <input type="tel" id="phone" placeholder="WhatsApp Phone Number" required pattern="^\+?\d{10,15}$">
    <button type="submit">
      <span class="material-icons">add_circle</span>
      Add Item
    </button>
  </form>
  <ul class="item-list" id="item-list"></ul>
  <!-- Popup for zoomed photo -->
  <div id="popup-backdrop" class="popup-backdrop" style="display:none;">
    <div class="popup-img-container">
      <img id="popup-img" class="popup-img" src="" alt="Zoomed Photo">
      <span id="popup-close" class="material-icons popup-close" title="Close">close</span>
    </div>
  </div>
  <script>
    let photoDataList = [];

    const uploadPhotosBtn = document.getElementById('upload-photos-btn');
    const uploadPhotosInput = document.getElementById('upload-photos-input');
    const thumbnails = document.getElementById('thumbnails');
    const itemForm = document.getElementById('item-form');
    const itemList = document.getElementById('item-list');
    const titleInput = document.getElementById('title');
    const phoneInput = document.getElementById('phone');
    const popupBackdrop = document.getElementById('popup-backdrop');
    const popupImg = document.getElementById('popup-img');
    const popupClose = document.getElementById('popup-close');

    // Upload from gallery (multiple photos)
    uploadPhotosBtn.onclick = () => uploadPhotosInput.click();
    uploadPhotosInput.onchange = (e) => {
      const files = Array.from(e.target.files || []);
      files.forEach(file => {
        const reader = new FileReader();
        reader.onload = function(evt) {
          photoDataList.push(evt.target.result);
          renderThumbnails();
        };
        reader.readAsDataURL(file);
      });
      uploadPhotosInput.value = '';
    };

    // Thumbnails
    function renderThumbnails() {
      thumbnails.innerHTML = '';
      photoDataList.forEach((data, idx) => {
        const cont = document.createElement('div');
        cont.className = 'thumb-container';
        const img = document.createElement('img');
        img.src = data;
        img.className = 'thumb-img';
        img.alt = 'Photo';
        img.onclick = () => openPopup(data);
        const rm = document.createElement('span');
        rm.className = 'material-icons remove-thumb';
        rm.textContent = 'close';
        rm.title = 'Remove photo';
        rm.onclick = (ev) => {
          ev.stopPropagation();
          photoDataList.splice(idx, 1);
          renderThumbnails();
        };
        cont.appendChild(img);
        cont.appendChild(rm);
        thumbnails.appendChild(cont);
      });
    }

    // Generate a random Ad-Code string
    function generateAdCode() {
      // Generates a random string like kshdsa8yddyd7
      const chars = 'abcdefghijklmnopqrstuvwxyz0123456789';
      let code = '';
      for (let i = 0; i < 13; i++) {
        code += chars[Math.floor(Math.random() * chars.length)];
      }
      return code;
    }

    // Add item form
    itemForm.onsubmit = function(e) {
      e.preventDefault();
      if (!photoDataList.length) {
        alert('Please upload at least one photo.');
        return;
      }
      const title = titleInput.value.trim();
      const phone = phoneInput.value.trim();
      if (!title || !phone) return;

      const adCode = generateAdCode();

      const li = document.createElement('li');
      li.className = 'item';

      const imagesDiv = document.createElement('div');
      imagesDiv.className = 'item-images';
      photoDataList.forEach(src => {
        const img = document.createElement('img');
        img.src = src;
        img.alt = title;
        img.onclick = () => openPopup(src);
        imagesDiv.appendChild(img);
      });

      // Info list with better icons
      const infoList = document.createElement('ul');
      infoList.className = 'info-list';

      const titleLi = document.createElement('li');
      // Use "label" or "info" icon for title (material icon)
      titleLi.innerHTML = `<span class="material-icons">label_important</span> <span>${title}</span>`;
      infoList.appendChild(titleLi);

      const phoneLi = document.createElement('li');
      phoneLi.innerHTML = `<span class="material-icons wa">whatsapp</span> <span>${phone}</span>`;
      infoList.appendChild(phoneLi);

      const adLi = document.createElement('li');
      adLi.innerHTML = `<span class="material-icons adcode">confirmation_number</span> <span>Ad-Code: <b>${adCode}</b></span>`;
      infoList.appendChild(adLi);

      li.appendChild(imagesDiv);
      li.appendChild(infoList);

      itemList.prepend(li);

      // Reset
      photoDataList = [];
      renderThumbnails();
      titleInput.value = '';
      phoneInput.value = '';
    };

    // Popup zoom
    function openPopup(imgSrc) {
      popupImg.src = imgSrc;
      popupBackdrop.style.display = 'flex';
      document.body.style.overflow = 'hidden';
    }
    function closePopup() {
      popupImg.src = '';
      popupBackdrop.style.display = 'none';
      document.body.style.overflow = '';
    }
    popupClose.onclick = closePopup;
    popupBackdrop.onclick = function(e) {
      if (e.target === popupBackdrop) closePopup();
    };
  </script>
</body>
</html>
