<!DOCTYPE html>
<html lang="en">
<head>
  <title>Pak Portal &mdash; 1 PPC = 100 Euros</title>
  <link href="https://fonts.googleapis.com/icon?family=Material+Icons" rel="stylesheet">
  <meta name="viewport" content="width=device-width,initial-scale=1">
  <style>
    html, body {
      font-size: 14px;
      font-family: 'Roboto', 'Arial', sans-serif;
      background: #ffffff;
      color: #333;
      margin: 0;
      min-height: 100vh;
      box-sizing: border-box;
      overflow-x: hidden;
    }
    body.blurred *:not(.key-modal, .key-modal *, .modal-overlay, .modal-overlay *) {
      filter: blur(3px) brightness(0.93);
      pointer-events: none !important;
      user-select: none !important;
    }
    .top-bar {
      width: 100%;
      background: #fff;
      border-bottom: 1.5px solid #ececec;
      display: flex;
      align-items: center;
      justify-content: space-between;
      box-shadow: 0 1px 6px 0 #ececec;
      min-height: 62px;
      position: sticky;
      top: 0;
      z-index: 10;
      margin-bottom: 15px;
    }
    .title {
      font-size: 28px;
      font-weight: 800;
      color: #7a3cff;
      display: flex;
      align-items: center;
      gap: 10px;
      padding: 0 32px;
      letter-spacing: 1.2px;
    }
    .exchange-rate {
      font-size: 14px;
      color: #42b883;
      background: #333;
      border-radius: 6px;
      padding: 2px 10px;
      margin-left: 13px;
      font-weight: 700;
      letter-spacing: 1.1px;
      display: inline-flex;
      align-items: center;
      gap: 4px;
    }
    .status-bar {
      display: flex;
      align-items: center;
      gap: 18px;
      font-size: 18px;
      padding: 0 32px;
    }
    .status-bar .material-icons {
      font-size: 22px;
      vertical-align: middle;
      color: #9699b3;
      margin-right: 2px;
    }
    .key-short {
      color: #7a3cff;
      font-weight: 600;
      font-size: 18px;
      background: #f5f3ff;
      border-radius: 8px;
      padding: 6px 16px;
      margin-right: 6px;
      letter-spacing: 1px;
      display: flex;
      align-items: center;
      gap: 5px;
    }
    .delete-btn {
      background: #eee;
      color: #7a3cff;
      border: none;
      border-radius: 6px;
      height: 36px;
      min-width: 36px;
      padding: 0;
      font-size: 20px;
      margin-left: 5px;
      display: flex;
      align-items: center;
      justify-content: center;
      cursor: pointer;
      transition: background 0.2s, color 0.2s;
    }
    .delete-btn:hover {
      background: #fdd;
      color: #e53935;
    }
    /* --- Sidebar tabs theme --- */
    .sidebar {
      position: fixed;
      top: 62px;
      left: 0;
      width: 260px;
      background: #fff;
      min-height: calc(100vh - 62px);
      z-index: 2;
      display: flex;
      flex-direction: column;
      align-items: stretch;
      padding: 24px 10px 24px 10px;
      gap: 20px;
    }
    .sidebar .balance-tab {
      background: #fff;
      border-radius: 16px;
      box-shadow: 0 3px 16px #ece6fa;
      padding: 17px 15px 13px 18px;
      min-width: 170px;
      display: flex;
      flex-direction: column;
      align-items: flex-start;
      gap: 6px;
      border-left: 7px solid #42b883;
      font-size: 16px;
      font-weight: 600;
      position: relative;
      margin-bottom: 0;
      transition: box-shadow 0.18s;
      cursor: pointer;
      outline: none;
      border-right: 3px solid transparent;
    }
    .balance-tab.selected, .sidebar .balance-tab.selected {
      box-shadow: 0 6px 18px #bdbdfd;
      border-right: 3px solid #7a3cff;
      background: #f5f3ff;
    }
    .balance-tab.earnings {
      border-left: 7px solid #42b883;
      background: #edfff2;
    }
    .balance-tab.available {
      border-left: 7px solid #7a3cff;
      background: #f5f3ff;
    }
    .balance-label {
      font-size: 14px;
      font-weight: 600;
      color: #42b883;
      display: flex;
      align-items: center;
      gap: 6px;
      margin-bottom: 0px;
      letter-spacing: 0.2px;
    }
    .balance-label.available {
      color: #7a3cff;
    }
    .balance-value {
      font-size: 18px;
      color: #222;
      font-weight: 500;
      letter-spacing: 0.2px;
      display: flex;
      align-items: baseline;
      gap: 2px;
      min-height: 20px;
      margin: 0;
      padding: 0;
      line-height: 1.1;
      width: 100%;
    }
    .balance-value span {
      font-size: 18px;
      font-weight: 500;
      margin-right: 3px;
    }
    .balance-value-eur {
      color: #888;
      font-size: 12px;
      font-weight: 400;
      margin-top: 1px;
      margin-left: 0;
      letter-spacing: 0.1px;
      line-height: 1.15em;
      display: block;
      width: 100%;
      word-break: break-word;
    }
    .sidebar .balance-tab .material-icons {
      font-size: 23px;
      margin-right: 6px;
      color: #42b883;
    }
    .sidebar .balance-tab.available .material-icons {
      color: #7a3cff;
    }
    /* --- Main content --- */
    .main-content {
      margin-left: 260px;
      padding-left: 0;
      transition: margin-left 0.2s;
    }
    @media (max-width: 1000px) {
      .sidebar {
        width: 100vw;
        min-height: unset;
        height: unset;
        position: static;
        flex-direction: row;
        padding: 8px 2vw;
        gap: 12px;
        box-shadow: none;
        border-right: none;
        border-bottom: 1px solid #ececec;
      }
      .sidebar .balance-tab {
        min-width: 140px;
        max-width: 200px;
        margin: 0;
      }
      .main-content {
        margin-left: 0;
        padding-left: 0;
      }
    }
    @media (max-width: 700px) {
      .sidebar {
        flex-direction: column;
        gap: 7px;
        padding: 4px 1vw;
      }
      .sidebar .balance-tab {
        min-width: unset;
        max-width: unset;
      }
      .main-content {
        margin-left: 0;
      }
    }
    /* --- Details etc. reused from previous theme --- */
    .sections-wrap {
      max-width: 900px;
      margin: 0 auto;
      padding: 0 18px 60px 18px;
    }
    .card-section {
      background: #fff;
      border-radius: 20px;
      box-shadow: 0 1px 10px 0 #ececec;
      margin-bottom: 28px;
      padding: 34px 34px 26px 34px;
      display: flex;
      flex-direction: column;
      gap: 18px;
    }
    .card-section.financial {
      background: #f7fcff;
      border-left: 7px solid #42b883;
      margin-bottom: 32px;
    }
    .section-title {
      font-size: 24px;
      font-weight: 800;
      color: #7a3cff;
      margin-bottom: 6px;
      letter-spacing: 1.3px;
      display: flex;
      align-items: center;
      gap: 10px;
    }
    .section-title.financial {
      color: #42b883;
    }
    .section-title.agreement {
      color: #1976d2;
    }
    .row {
      display: flex;
      align-items: flex-start;
      gap: 22px;
      font-size: 19px;
      font-weight: 500;
      color: #444;
      margin: 0 0 10px 0;
      padding: 0 0 0 2px;
    }
    .row .label {
      min-width: 170px;
      font-weight: 700;
      color: #7a3cff;
      display: flex;
      align-items: center;
      gap: 8px;
    }
    .row .label.financial {
      color: #42b883;
    }
    .row .value {
      color: #333;
      font-weight: 600;
      display: flex;
      align-items: center;
      gap: 6px;
    }
    .row .date {
      color: #888;
      font-size: 15px;
      margin-left: 18px;
      font-weight: 500;
      letter-spacing: .5px;
      display: flex;
      align-items: center;
      gap: 3px;
    }
    .row .material-icons {
      font-size: 22px;
      color: #7a3cff;
      margin-right: 5px;
      vertical-align: middle;
    }
    .row .material-icons.financial {
      color: #42b883;
    }
    .step-desc {
      font-size: 16px;
      color: #249a60;
      background: #edfff2;
      border-radius: 8px;
      margin: -10px 0 18px 10px;
      padding: 9px 18px 10px 24px;
      border-left: 3px solid #42b883;
    }
    /* Fullscreen image modal */
    .fullscreen-modal {
      display: none;
      position: fixed;
      z-index: 9999;
      left: 0; top: 0; right: 0; bottom: 0;
      width: 100vw; height: 100vh;
      background: rgba(30,24,50,0.93);
      align-items: center;
      justify-content: center;
      flex-direction: column;
      animation: fadeIn .2s;
    }
    .fullscreen-modal.active { display: flex; }
    .fullscreen-img {
      max-width: 92vw;
      max-height: 82vh;
      border-radius: 14px;
      box-shadow: 0 6px 32px #333;
      background: #fff;
      object-fit: contain;
    }
    .close-modal-btn {
      position: absolute;
      top: 32px;
      right: 48px;
      background: rgba(30,24,50,0.4);
      color: #fff;
      border: none;
      border-radius: 50%;
      width: 48px; height: 48px;
      cursor: pointer;
      display: flex;
      align-items: center;
      justify-content: center;
      font-size: 33px;
      z-index: 10001;
      transition: background 0.2s;
    }
    .close-modal-btn:hover {
      background: #7a3cff;
    }
    .images-row {
      display: flex;
      gap: 18px;
      margin-top: 7px;
      margin-bottom: 7px;
      flex-wrap: wrap;
    }
    .product-image {
      width: 160px;
      height: 120px;
      border-radius: 12px;
      object-fit: cover;
      box-shadow: 0 2px 10px #ececec;
      border: 2px solid #eaeaea;
      background: #fff;
      cursor: pointer;
      transition: box-shadow 0.2s;
    }
    .product-image:hover {
      box-shadow: 0 6px 24px #bdbdbd;
      border-color: #7a3cff;
    }
    .agreement-list {
      display: flex;
      flex-direction: column;
      gap: 11px;
      font-size: 18px;
      margin-top: 8px;
      margin-bottom: 6px;
    }
    .agreement-list .agreement-item {
      display: flex;
      align-items: center;
      gap: 10px;
      color: #1976d2;
      background: #e3f2fd;
      padding: 10px 18px;
      border-radius: 8px;
      font-weight: 500;
    }
    .agreement-list .material-icons {
      color: #1976d2;
      font-size: 22px;
    }
    /* Modal overlay and key modal */
    .modal-overlay {
      position: fixed;
      left:0; top:0; right:0; bottom:0;
      width:100vw; height:100vh;
      background: rgba(40,30,60,0.25);
      z-index: 10000;
      display: flex;
      align-items: center;
      justify-content: center;
    }
    .key-modal {
      background: #fff;
      color: #222;
      border-radius: 14px;
      box-shadow: 0 8px 32px #7a3cff40;
      padding: 22px 18px 18px 18px;
      min-width: 290px;
      max-width: 96vw;
      display: flex;
      flex-direction: column;
      align-items: center;
      gap: 16px;
      z-index: 10001;
      font-size: 14px;
      font-weight: 400;
    }
    .key-modal .material-icons { color: #7a3cff; font-size: 24px;}
    .key-modal label { font-weight: 500; font-size: 13px;}
    .key-modal input[type="text"] {
      width: 220px;
      font-size: 14px;
      border: 1px solid #bbb;
      border-radius: 8px;
      padding: 7px 11px;
      margin-top: 3px;
      outline: none;
      transition: border 0.2s;
    }
    .key-modal input[type="text"]:focus { border: 1px solid #7a3cff;}
    .key-modal button {
      background: #7a3cff;
      color: #fff;
      border: none;
      border-radius: 8px;
      padding: 7px 22px;
      font-size: 14px;
      font-weight: 500;
      cursor: pointer;
      margin-top: 0;
      transition: background 0.2s;
    }
    .key-modal button:hover { background: #6338c7;}
  </style>
</head>
<body>
  <div class="top-bar">
    <div class="title">
      <span class="material-icons">dashboard</span>
      Pak Portal
      <span class="exchange-rate"><span class="material-icons" style="font-size:18px;vertical-align:middle;">euro</span>1 PPC = 100 EUROS</span>
    </div>
    <div class="status-bar">
      <span title="Your Key" class="key-short" id="keyShort">
        <span class="material-icons">vpn_key</span>
        <span id="keyShortValue">---</span>
        <button class="delete-btn" title="Remove Key" id="deleteKeyBtn">
          <span class="material-icons">delete</span>
        </button>
      </span>
    </div>
  </div>
  <!-- Sidebar with tabs -->
  <div class="sidebar" id="sidebarTabs">
    <div class="balance-tab" id="tab-potential" tabindex="0">
      <div class="balance-label"><span class="material-icons">trending_up</span>Potential Earnings</div>
      <div class="balance-value">
        <span id="potentialPPC">--</span> <span style="font-size:13px;font-weight:400;">PPC</span>
      </div>
      <span class="balance-value-eur" id="potentialEur">-- €</span>
    </div>
    <div class="balance-tab available selected" id="tab-available" tabindex="0">
      <div class="balance-label available"><span class="material-icons">account_balance_wallet</span>Earnings Available</div>
      <div class="balance-value">
        <span id="availablePPC">--</span> <span style="font-size:13px;font-weight:400;">PPC</span>
      </div>
      <span class="balance-value-eur" id="availableEur">-- €</span>
    </div>
    <div class="balance-tab" id="tab-withdrawn" tabindex="0">
      <div class="balance-label"><span class="material-icons">euro</span>Earnings Withdrawn</div>
      <div class="balance-value">
        <span id="withdrawnPPC">--</span> <span style="font-size:13px;font-weight:400;">PPC</span>
      </div>
      <span class="balance-value-eur" id="withdrawnEur">-- €</span>
    </div>
  </div>
  <div class="main-content">
    <div class="sections-wrap">
      <div class="card-section financial">
        <div class="section-title financial"><span class="material-icons financial">account_balance</span>Financial Management</div>
        <div class="row">
          <span class="label financial"><span class="material-icons financial">add_circle</span>Order Available to Earn 5000 PPC</span>
          <span class="date"><span class="material-icons financial">calendar_today</span>2025-06-10</span>
        </div>
        <div class="step-desc">
          Order published and available for earning 5,000 PPC. Processed by PakPortal Agent.
        </div>
        <div class="row">
          <span class="label financial"><span class="material-icons financial">check_circle</span>5000 PPC Earned by Signing the Agreement</span>
          <span class="date"><span class="material-icons financial">calendar_today</span>2025-06-12</span>
        </div>
        <div class="step-desc">
          5,000 PPC credited after agreement signed. Processed by PakPortal Agent.
        </div>
        <div class="row">
          <span class="label financial"><span class="material-icons financial">euro</span>5000 PPC Withdrawn to Euros</span>
          <span class="date"><span class="material-icons financial">calendar_today</span>2025-06-15</span>
        </div>
        <div class="step-desc">
          5,000 PPC withdrawn and paid as 500,000 Euros. Processed by PakPortal Agent.
        </div>
      </div>
      <div class="card-section">
        <div class="section-title"><span class="material-icons">info</span>Product Details</div>
        <div class="row">
          <span class="label"><span class="material-icons">shopping_cart</span>Product</span>
          <span class="value">Mobile Recharge</span>
        </div>
        <div class="row">
          <span class="label"><span class="material-icons">branding_watermark</span>Brand</span>
          <span class="value">Jazz Pakistan</span>
        </div>
        <div class="row">
          <span class="label"><span class="material-icons">description</span>Description</span>
          <span class="value">Prepaid mobile recharge for Jazz Pakistan numbers with instant topup delivery and support.</span>
        </div>
        <div class="row" style="align-items: flex-start;">
          <span class="label"><span class="material-icons">image</span>Images</span>
          <span class="value images-row">
            <img class="product-image" src="https://res.cloudinary.com/de3kzkvhd/image/upload/v1749534470/2pXm5tQ_bynr4g.jpg" alt="Product Image 1">
            <img class="product-image" src="https://res.cloudinary.com/de3kzkvhd/image/upload/v1749534437/7iXvJCv_dggatx.jpg" alt="Product Image 2">
          </span>
        </div>
      </div>
      <div class="card-section" style="background:#f3f9ff;border-left:7px solid #1976d2;">
        <div class="section-title agreement">
          <span class="material-icons agreement">fact_check</span>Agreement
        </div>
        <div class="agreement-list">
          <div class="agreement-item"><span class="material-icons">check</span>I agree to provide this product</div>
          <div class="agreement-item"><span class="material-icons">local_shipping</span>I can ship this product to the given address</div>
          <div class="agreement-item"><span class="material-icons">build</span>I will be responsible for shipping and repair</div>
          <div class="agreement-item"><span class="material-icons">update</span>I will provide all updates to PakPortal</div>
          <div class="agreement-item"><span class="material-icons">event_note</span>I will keep all transaction records with PakPortal</div>
          <div class="agreement-item"><span class="material-icons">autorenew</span>I will process orders promptly and professionally</div>
          <div class="agreement-item"><span class="material-icons">assignment_turned_in</span>I will follow PakPortal's terms and conditions</div>
          <div class="agreement-item"><span class="material-icons">groups</span>I will cooperate with PakPortal team for any support or clarification</div>
          <div class="agreement-item"><span class="material-icons">done_all</span>I will ensure customer satisfaction and transparency</div>
        </div>
      </div>
    </div>
  </div>
  <!-- Fullscreen Image Modal -->
  <div class="fullscreen-modal" id="fullscreenModal">
    <button class="close-modal-btn" id="closeModalBtn" title="Close">
      <span class="material-icons">close</span>
    </button>
    <img class="fullscreen-img" id="fullscreenImg" src="" alt="Full Image">
  </div>
  <!-- Key Modal Popup -->
  <div class="modal-overlay" id="keyModalOverlay" style="display:none;">
    <div class="key-modal">
      <span class="material-icons" style="font-size:24px;">vpn_key</span>
      <label for="keyInput">Enter Your Polygon (Ethereum) Address:</label>
      <input type="text" id="keyInput" placeholder="0x...">
      <button id="saveKeyBtn">Save Key</button>
    </div>
  </div>
  <!-- Include web3 for real wallet balance (user tab) -->
  <script src="https://cdn.jsdelivr.net/npm/web3@1.8.0/dist/web3.min.js"></script>
  <script>
    // Demo wallet addresses for potential and withdrawn. Change as needed.
    const DEMO_WALLETS = {
      potential: "0x4a6BeC171eda4a965215d13e236380D7AC6Ad0d1",
      withdrawn: "0x742d35Cc6634C0532925a3b844Bc454e4438f44e"
    };
    const PPC_TO_EUR = 100;
    // NFTFAN contract (PPC) on Polygon, change as needed for actual token
    const NFTFAN_CA = "0x2017Fcaea540d2925430586DC92818035Bfc2F50";
    const ERC20_ABI = [
      {"constant":true,"inputs":[{"name":"_owner","type":"address"}],"name":"balanceOf","outputs":[{"name":"balance","type":"uint256"}],"type":"function"},
      {"constant":true,"inputs":[],"name":"decimals","outputs":[{"name":"","type":"uint8"}],"type":"function"}
    ];
    const KEY_STORAGE = "PPC-key";
    const web3 = new Web3("https://polygon-rpc.com/");
    const nftfan = new web3.eth.Contract(ERC20_ABI, NFTFAN_CA);

    function shortKey(addr) {
      if (!addr) return "---";
      return addr.slice(0, 6) + "..." + addr.slice(-4);
    }
    function formatNumber(numStr, decimals) {
      if (!numStr) return "--";
      try {
        let n = BigInt(numStr);
        let div = BigInt(10) ** BigInt(decimals);
        let w = n / div;
        return w.toLocaleString('en-US');
      } catch {
        return "--";
      }
    }
    function formatEUR(ppc) {
      if (!ppc || isNaN(ppc.replace(/,/g,''))) return "--";
      let num = parseInt(ppc.replace(/,/g,''), 10);
      return (num * PPC_TO_EUR).toLocaleString('en-US') + " €";
    }
    function setTabBalance(tabPrefix, ppcStr) {
      document.getElementById(tabPrefix + "PPC").textContent = ppcStr;
      document.getElementById(tabPrefix + "Eur").textContent = (ppcStr !== "--") ? "≈ " + formatEUR(ppcStr) : "-- €";
    }
    async function fetchPPC(addr, tabPrefix) {
      try {
        const [bal, dec] = await Promise.all([
          nftfan.methods.balanceOf(addr).call(),
          nftfan.methods.decimals().call()
        ]);
        let balStr = formatNumber(bal, dec);
        setTabBalance(tabPrefix, balStr);
      } catch {
        setTabBalance(tabPrefix, "--");
      }
    }
    // Modal for key input
    function showKeyModal() {
      document.getElementById('keyModalOverlay').style.display = 'flex';
      document.body.classList.add("blurred");
      setTimeout(() => { document.getElementById('keyInput').focus(); }, 100);
    }
    function hideKeyModal() {
      document.getElementById('keyModalOverlay').style.display = 'none';
      document.body.classList.remove("blurred");
    }
    function getStoredKey() {
      return localStorage.getItem(KEY_STORAGE);
    }
    function saveKey(addr) {
      localStorage.setItem(KEY_STORAGE, addr);
    }
    function afterKeySet(addr) {
      document.getElementById('keyShortValue').textContent = shortKey(addr);
      fetchPPC(addr, "available");
      document.body.classList.remove("blurred");
    }
    document.getElementById('deleteKeyBtn').onclick = function() {
      localStorage.removeItem(KEY_STORAGE);
      document.getElementById('keyShortValue').textContent = "---";
      showKeyModal();
    };
    document.getElementById('saveKeyBtn').onclick = function() {
      let addr = document.getElementById('keyInput').value.trim();
      if (!/^0x[a-fA-F0-9]{40}$/.test(addr)) {
        alert("Please enter a valid Polygon (Ethereum) address.");
        document.getElementById('keyInput').focus();
        return;
      }
      saveKey(addr);
      hideKeyModal();
      afterKeySet(addr);
    };
    document.getElementById('keyInput').addEventListener('keydown', function(e){
      if(e.key === "Enter") document.getElementById('saveKeyBtn').click();
    });
    // Sidebar tab selection and balance logic
    let currentTab = "available";
    function selectTab(tab) {
      document.querySelectorAll('.sidebar .balance-tab').forEach(t => t.classList.remove("selected"));
      document.getElementById('tab-' + tab).classList.add("selected");
      currentTab = tab;
      showCurrentTabBalance();
    }
    // Show the correct value in each tab
    function showCurrentTabBalance() {
      if (currentTab === "available") {
        let addr = getStoredKey();
        if (addr && /^0x[a-fA-F0-9]{40}$/.test(addr)) {
          fetchPPC(addr, "available");
        } else {
          setTabBalance("available", "--");
        }
      } else if (currentTab === "potential") {
        fetchPPC(DEMO_WALLETS.potential, "potential");
      } else if (currentTab === "withdrawn") {
        fetchPPC(DEMO_WALLETS.withdrawn, "withdrawn");
      }
    }
    document.addEventListener("DOMContentLoaded", function() {
      // Tab click handlers
      document.getElementById("tab-potential").onclick = function() { selectTab("potential"); };
      document.getElementById("tab-available").onclick = function() { selectTab("available"); };
      document.getElementById("tab-withdrawn").onclick = function() { selectTab("withdrawn"); };
      // Fullscreen image modal logic
      var images = document.querySelectorAll('.product-image');
      images.forEach(function(img) {
        img.addEventListener('click', function() {
          showFullscreenImage(img.src);
        });
      });
      document.getElementById('closeModalBtn').onclick = closeFullscreenImage;
      document.getElementById('fullscreenModal').onclick = function(e) {
        if (e.target === this) closeFullscreenImage();
      };
      document.getElementById('keyModalOverlay').onclick = function(e) {
        if (e.target === this) return false;
      };
      // KEY logic
      let addr = getStoredKey();
      if (!addr || !/^0x[a-fA-F0-9]{40}$/.test(addr)) {
        showKeyModal();
      } else {
        afterKeySet(addr);
        fetchPPC(DEMO_WALLETS.potential, "potential");
        fetchPPC(DEMO_WALLETS.withdrawn, "withdrawn");
      }
      // Default: show available (user) balance, but also update all tabs once
      selectTab("available");
      // Optionally, update every minute (simulate refresh)
      setInterval(showCurrentTabBalance, 60000);
    });
    // Fullscreen image modal logic
    function showFullscreenImage(src) {
      var modal = document.getElementById('fullscreenModal');
      var img = document.getElementById('fullscreenImg');
      img.src = src;
      modal.classList.add('active');
    }
    function closeFullscreenImage() {
      var modal = document.getElementById('fullscreenModal');
      modal.classList.remove('active');
      document.getElementById('fullscreenImg').src = "";
    }
  </script>
</body>
</html>
